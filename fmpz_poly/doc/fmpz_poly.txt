/*============================================================================

    Copyright (C) 2008, 2009 William Hart

    This file is part of FLINT.

    FLINT is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    FLINT is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with FLINT; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

===============================================================================*/

********************************************************************************

  Memory management

********************************************************************************

void fmpz_poly_init(fmpz_poly_t poly)

   Initialise the poly for use. The length is set to zero.

void fmpz_poly_init2(fmpz_poly_t poly, const ulong alloc)

   Initialise the poly with space for at least alloc coefficients and
   set the length to zero. The alloc coefficients are all set to zero.

void fmpz_poly_realloc(fmpz_poly_t poly, const ulong alloc)

   Reallocate the given polynomial to have space for alloc coefficients.
   If alloc is set to zero then the polynomial is cleared and then
   reinitialised. If the current length is greater than alloc the poly
   is first truncated to length alloc.

void fmpz_poly_fit_length(fmpz_poly_t poly, const ulong length)

   If length is currently greater that the number of coefficients
   allocated, then the polynomial is reallocated to have space for at
   least length coefficients. No data is lost when calling this 
   function. The function efficiently deals with the case where 
   fit_length is called many times in small increments by at least 
   doubling the number of allocated coefficients when length is larger 
   than the number of coefficients currently allocated.

void fmpz_poly_clear(fmpz_poly_t poly)

   Clear the given poly, releasing any memory used. The poly must
   be reinitialised in order to be used again.

void _fmpz_poly_normalise(fmpz_poly_t poly)

   Set the length of poly so that the top coefficient is nonzero. If
   all coefficients are zero, the length is set to zero. This function
   is mainly used internally, as all functions guarantee normalisation.

void fmpz_poly_truncate(fmpz_poly_t poly, const ulong length)

   If the current length of poly is greater than length, it is truncated
   to have the given length. Discarded coefficients are not necessarily 
   set to zero.

********************************************************************************

  Random polynomials

********************************************************************************

void fmpz_poly_randinit()
   Initialise the random state for random polynomial generation. One 
   should not call this function if fmpz_randinit has already been 
   called. 

void fmpz_poly_randclear()
   Clear the random state initialised with fmpz_poly_randinit. One 
   should not call this function if fmpz_randclear has already been
   called.

void fmpz_poly_randtest(fmpz_poly_t f, ulong length, mp_bitcnt_t bits_in)

   Sets f to a random polynomial with up to the given length and where
   each coefficient has up to the given number of bits. The coefficients
   are signed randomly. One must call fmpz_poly_randinit before calling
   this function.

void fmpz_poly_randtest_not_zero(fmpz_poly_t f, ulong length, mp_bitcnt_t bits_in)

   As for fmpz_poly_randtest except that length and bits_in may not be
   zero and the polynomial generated is guaranteed not to be the 
   zero polynomial. One must call fmpz_poly_randinit before calling
   this function.

********************************************************************************

  Coefficient get/set

********************************************************************************

long fmpz_poly_get_coeff_si(const fmpz_poly_t poly, const ulong n)
   
   Get coefficient n of poly as a long. The result is undefined if the 
   value does not fit into a long. Coefficient numbering is from zero and 
   if n is set to a value beyond the end of the polynomial, zero is 
   returned.

void fmpz_poly_set_coeff_si(fmpz_poly_t poly, ulong n, const long x)

   Set coefficient n of poly to the long value x. Coefficient numbering
   starts from zero and if n is beyond the current length of poly then
   the polynomial is extended and zero coefficients inserted if 
   necessary.

long fmpz_poly_get_coeff_ui(const fmpz_poly_t poly, const ulong n)
   
   Get coefficient n of poly as a ulong. The result is undefined if the 
   value does not fit into a ulong. Coefficient numbering is from zero and 
   if n is set to a value beyond the end of the polynomial, zero is 
   returned.

void fmpz_poly_set_coeff_ui(fmpz_poly_t poly, ulong n, const ulong x)

   Set coefficient n of poly to the ulong value x. Coefficient numbering
   starts from zero and if n is beyond the current length of poly then
   the polynomial is extended and zero coefficients inserted if 
   necessary.

void fmpz_poly_get_coeff_fmpz(fmpz_t x, const fmpz_poly_t poly, const ulong n)

   Get coefficient n of poly as an fmpz. Coefficient numbering is from zero 
   and if n is set to a value beyond the end of the polynomial, zero is 
   returned.

void fmpz_poly_set_coeff_fmpz(fmpz_poly_t poly, ulong n, const fmpz_t x)

   Set coefficient n of poly to the fmpz value x. Coefficient numbering
   starts from zero and if n is beyond the current length of poly then
   the polynomial is extended and zero coefficients inserted if 
   necessary.

********************************************************************************

  Input/output

********************************************************************************

void fmpz_poly_print(fmpz_poly_t poly)

   Print the polynomial to stdout. First the length of the polynomial is
   printed. If the length is not zero two spaces are printed after the 
   length, then a space separated list of coefficients is printed, starting
   with the constant coefficient.

********************************************************************************

  Assignment, swap, negation, reverse

********************************************************************************

void fmpz_poly_set(fmpz_poly_t poly1, const fmpz_poly_t poly2)

   Set poly1 to equal poly2.

void fmpz_poly_swap(fmpz_poly_t poly1, fmpz_poly_t poly2)

   Swap poly1 and poly2. This is done efficiently without copying data
   by swapping pointers, etc.

void fmpz_poly_neg(fmpz_poly_t res, const fmpz_poly_t poly)

   Set res to -poly.

********************************************************************************

  Comparison

********************************************************************************

int fmpz_poly_equal(const fmpz_poly_t poly1, const fmpz_poly_t poly2)

   Return 1 if poly1 is equal to poly2, otherwise return 0. Polys are
   assumed to be normalised.
