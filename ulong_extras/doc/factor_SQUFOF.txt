/*============================================================================

    Copyright (C) 2009 William Hart

    This file is part of FLINT.

    FLINT is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    FLINT is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with FLINT; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

===============================================================================*/

mp_limb_t n_factor_SQUFOF(mp_limb_t n, ulong iters)

   Attempts to split n using the given number of iterations
   of SQUFOF. Simply set iters to ~0L for maximum persistence.

   The version of SQUFOF imlemented here is as described in 
   "Square form factoring" by Jason Gower and Sam Wagstaff,
   Math. Comp. 77, 2008, pp 551-588, see:
   http://www.ams.org/mcom/2008-77-261/S0025-5718-07-02010-8/home.html

   We start by trying SQUFOF directly on n. If that fails we
   multiply it by each of the primes in flint_primes_small in
   turn. As this multiplication may result in a two limb value
   we allow this in our implementation of SQUFOF. As SQUFOF 
   works with values about half the size of n it only needs 
   single limb arithmetic internally.

   If SQUFOF fails to factor n we teturn 0, however with 
   sufficient iterations this doesn't occur in practice.